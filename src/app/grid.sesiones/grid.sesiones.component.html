<h5 class="mb-3">Sesiones del Evento</h5>

<table class="table table-bordered">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Hora Inicio</th>
      <th>Hora Fin</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <!-- Lista de sesiones con scroll -->
    <tr>
      <td colspan="4" style="padding: 0;">
        <div style="max-height: 250px; overflow-y: auto;">
          <table class="table mb-0">
            <tbody>
              @for (control of sesiones; track $index) {
                <tr [formGroup]="control">
                  <td>
                    <input
                      type="date"
                      class="form-control"
                      formControlName="fecha"
                      [readonly]="soloLectura()"
                      (keydown.enter)="$event.stopPropagation()"
                      (blur)="notificarCambio()"
                    />
                  </td>
                  <td>
                    <input
                      type="time"
                      class="form-control"
                      formControlName="horaInicio"
                      [readonly]="soloLectura()"
                      (keydown.enter)="$event.stopPropagation()"
                      (blur)="notificarCambio()"
                    />
                  </td>
                  <td>
                    <input
                      type="time"
                      class="form-control"
                      formControlName="horaFin"
                      [readonly]="soloLectura()"
                      (keydown.enter)="$event.stopPropagation()"
                      (blur)="notificarCambio()"
                    />
                  </td>
                  <td class="d-flex gap-1">
                    <button
                      class="btn btn-danger btn-sm"
                      (click)="eliminarSesion($index)"
                      [disabled]="soloLectura()"
                    >
                      Eliminar
                    </button>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </td>
    </tr>

    <!-- Formulario para nueva sesiÃ³n -->
    @if (!soloLectura()) {
      <tr [formGroup]="nuevaSesionForm">
        <td>
          <input
            type="date"
            formControlName="fecha"
            class="form-control"
            [ngClass]="{ 'is-invalid': nuevaSesionForm.get('fecha')?.invalid && nuevaSesionForm.get('fecha')?.touched }"
            (keydown.enter)="$event.stopPropagation()"
          />
        </td>
        <td>
          <input
            type="time"
            formControlName="horaInicio"
            class="form-control"
            [ngClass]="{ 'is-invalid': nuevaSesionForm.get('horaInicio')?.invalid && nuevaSesionForm.get('horaInicio')?.touched }"
            (keydown.enter)="$event.stopPropagation()"
          />
        </td>
        <td>
          <input
            type="time"
            formControlName="horaFin"
            class="form-control"
            [ngClass]="{ 'is-invalid': nuevaSesionForm.get('horaFin')?.invalid && nuevaSesionForm.get('horaFin')?.touched }"
            (keydown.enter)="$event.stopPropagation()"
          />
        </td>
        <td>
          <button
            class="btn btn-primary btn-sm"
            (click)="agregarSesion()"
            [disabled]="nuevaSesionForm.invalid"
          >
            Agregar
          </button>
        </td>
      </tr>
    }
  </tbody>
</table>
